library(dbscan)
library(dplyr)

data <- read.csv2("C:/Users/emers/OneDrive/Documentos/Unsupervisioned-Machine-Learning-main/data/Assignment-1_Data.csv")

data_updated <- data %>%
  select(-c('BillNo', 'Itemname', 'Date'))
data_updated <- na.omit(data_updated)

data_updated$Country <- as.numeric(factor(data_updated$Country))
summary(data_updated)
str(data_updated)

data_updated <- data_updated[data_updated$Quantity <= 5000, ]

### model 1 ###
PCA <- prcomp(data_updated)
plot(PCA$x[, 1], PCA$x[, 2])

### model 2 ###
kmea <- kmeans(data_updated, centers=3)
plot(kmea$cluster)
plot(data_updated$CustomerID, data_updated$Country, col=kmea$cluster)

### model 3 ###
dbs <- dbscan(data_updated, eps=0.5, minPts=5)
plot(data_updated$CustomerID, data_updated$Country, col=dbs$cluster)
